<h1>Greetings {{user.username}}</h1>

<div *ngIf="user.role == 'super' || user.role == 'admin'">
  <h3>Create User</h3>
  <Form>
    <input type="text" [(ngModel)]="newUser" name="newUser" id="newUser" placeholder="Username"/><br>
    <input type="text" [(ngModel)]="newEmail" name="newEmail" id="newEmail" placeholder="Email"/><br>
    <select [(ngModel)]="newRole" name="newRole" required>
      <option value ="" selected>Select Role</option>
      <option value="user">User</option>
      <option value="assis">Group Assistant</option>
      <option value="admin" *ngIf="user.role == 'super'">Group Administrator</option>
    </select>
    <input type="submit" value="Go" (click)="createUser()"/>
    <div *ngIf="newRole == 'Group Assis'">
    <select>
      <option disabled selected>Which Group?</option>
    </select>
    </div>
  </Form>
  <div *ngIf="createError">
    <h4>{{createError}}</h4>
  </div>
</div>

<div *ngIf="user.role == 'super'">
  <h3>Delete User</h3>
  <form>
    <select [(ngModel)]="killUser" name="killUser" required>
        <option value=""  selected>Select User</option>
        <option *ngFor="let u of users">
          {{u.username}}
        </option>
    </select>
    <input type="button" value="Delete User" (click)="destroyUser()">
  </form>
  <div *ngIf="killError">
    <h4>{{killError}}</h4>
  </div>
</div>

<div *ngIf="user.role == 'super' || user.role == 'admin'">
  <h3>Promote User</h3>
  <form>
    <select [(ngModel)]="boostUser" name="boostUser" required>
        <option value="" selected>Select User</option>
        <ng-container *ngFor="let u of users">
          <option *ngIf="user.role == 'super' && u.role != 'super'">
            {{u.username}}
          </option>
        </ng-container>
        <ng-container *ngFor="let u of users">
          <option *ngIf="u.role == 'admin' && u.role != 'super' && u.role != 'admin'">
            {{u.username}}
          </option>
        </ng-container> 
    </select>
    <ng-container *ngIf="boostUser">
      <h4>Promote {{boostUser}} to which role?</h4>
      <select [(ngModel)]="boostRole" name="boostRole" required>
          <option value="" selected>Select Role</option>
          <ng-container *ngIf="user.role == 'super'">
              <ng-container *ngFor="let u of users">
                  <option value="super" *ngIf="u.username == boostUser && u.role != super">
                    Super
                  </option>
                  <option value="admin" *ngIf="u.username == boostUser && u.role == 'user' || u.role == 'assis'">
                    Group Administrator
                  </option>
                  <option value="assis" *ngIf="u.username == boostUser && u.role == 'user'">
                    Group Assistant
                  </option>
              </ng-container>
          </ng-container>
          <ng-container *ngIf="user.role == 'admin'">
              <ng-container *ngFor="let u of users">
                  <option value="assis" *ngIf="u.username == boostUser && u.role == 'user'">
                    Group Assistant
                  </option>
              </ng-container>
          </ng-container>
      </select>
    </ng-container>
    <input type="button" value="Promote User" (click)="promoteUser()">
  </form>
</div>
<div *ngIf="promoteError">
  <h4>{{promoteError}}</h4>
</div>

<div *ngIf="user.role == 'super' || user.role == 'admin'">
  <h3>Create Group</h3>
    <form>
      <input type="text" [(ngModel)]="newGroup" name="newGroup" id="newGroup" placeholder="Group Name">
        <ng-container *ngIf="user.role == 'admin' && newGroup">
          <h4>Check this box if you want to be Admin</h4>
          <input type="radio" [(ngModel)]=newAdmin name="newAdmin" value="{{username}}">
        </ng-container>
      <div *ngIf="gCreateError">
        {{gCreateError}}
      </div>
      <ng-container *ngIf="user.role == 'super' && newGroup">
        <h4>Assign an Administrator?</h4>
        <select [(ngModel)]="newAdmin" name="newAdmin" id="newAdmin">
          <option value="" selected>Not right now</option>
          <ng-container *ngFor="let u of users">
            <option *ngIf="u.role == 'admin'">
              {{u.username}}
            </option>
          </ng-container>
        </select>
      </ng-container>
      <input type="button" value="Create Group" (click)="createGroup()">
    </form>
    <div *ngIf="error">
        {{error}}
      </div>
</div>
